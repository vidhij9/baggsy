{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{motion}from'framer-motion';import{toast}from'react-toastify';import{ArchiveBoxIcon}from'@heroicons/react/24/solid';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function RegisterChildModal(_ref){let{parent,closeModal,setError}=_ref;const[qr,setQr]=useState('');const[currentCount,setCurrentCount]=useState(0);const[isLoading,setIsLoading]=useState(false);const handleSubmit=async e=>{e.preventDefault();setIsLoading(true);try{const res=await axios.post('http://localhost:8080/api/register-child',{qrCode:qr,type:'child',parentId:parent.id});setCurrentCount(res.data.currentCount);setQr('');if(res.data.currentCount===res.data.capacity){closeModal();toast.success('All child bags registered! Parent bag completed.',{position:'top-center'});}else{toast.success('Child seed bag registered!',{position:'top-center'});}setError(null);}catch(err){var _err$response;if(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===401){setError('Session expired. Please log in again.');toast.error('Session expired. Logging out...',{position:'top-center'});}else{var _err$response2,_err$response2$data,_err$response3,_err$response3$data;setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.error)||'Registration failed');toast.error(((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.error)||'Registration failed',{position:'top-center'});}}finally{setIsLoading(false);}};return/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0},animate:{opacity:1},className:\"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-xl shadow-lg border-t-4 border-primary w-full max-w-md\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl font-semibold text-accent mb-4 flex items-center\",children:[/*#__PURE__*/_jsx(ArchiveBoxIcon,{className:\"w-6 h-6 text-primary mr-2\"}),\"Register Child Bags for \",parent.qrCode]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-accent mb-4\",children:[\"Current: \",currentCount,\"/\",parent.childCount]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"input\",{value:qr,onChange:e=>setQr(e.target.value),placeholder:\"Scan Child QR\",className:\"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-accent\",required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-3\",children:/*#__PURE__*/_jsx(motion.div,{className:\"bg-primary h-3 rounded-full\",initial:{width:0},animate:{width:`${currentCount/parent.childCount*100}%`},transition:{duration:0.5}})}),/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",disabled:isLoading,className:`w-full py-3 rounded-lg text-white flex items-center justify-center ${isLoading?'bg-gray-400':'bg-primary hover:bg-green-700'} transition duration-300`,children:[isLoading?/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin h-5 w-5 mr-2\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8v8z\"})]}):/*#__PURE__*/_jsx(ArchiveBoxIcon,{className:\"w-5 h-5 mr-2\"}),\"Register Child\"]})]})]})});}export default RegisterChildModal;","map":{"version":3,"names":["React","useState","useEffect","axios","motion","toast","ArchiveBoxIcon","jsx","_jsx","jsxs","_jsxs","RegisterChildModal","_ref","parent","closeModal","setError","qr","setQr","currentCount","setCurrentCount","isLoading","setIsLoading","handleSubmit","e","preventDefault","res","post","qrCode","type","parentId","id","data","capacity","success","position","err","_err$response","response","status","error","_err$response2","_err$response2$data","_err$response3","_err$response3$data","div","initial","opacity","animate","className","children","childCount","onSubmit","value","onChange","target","placeholder","required","width","transition","duration","disabled","viewBox","cx","cy","r","stroke","strokeWidth","fill","d"],"sources":["/Users/mannu/Desktop/baggsy/frontend/src/components/RegisterChildModal.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { motion } from 'framer-motion';\nimport { toast } from 'react-toastify';\nimport { ArchiveBoxIcon } from '@heroicons/react/24/solid';\n\nfunction RegisterChildModal({ parent, closeModal, setError }) {\n  const [qr, setQr] = useState('');\n  const [currentCount, setCurrentCount] = useState(0);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setIsLoading(true);\n    try {\n      const res = await axios.post('http://localhost:8080/api/register-child', {\n        qrCode: qr,\n        type: 'child',\n        parentId: parent.id,\n      });\n      setCurrentCount(res.data.currentCount);\n      setQr('');\n      if (res.data.currentCount === res.data.capacity) {\n        closeModal();\n        toast.success('All child bags registered! Parent bag completed.', { position: 'top-center' });\n      } else {\n        toast.success('Child seed bag registered!', { position: 'top-center' });\n      }\n      setError(null);\n    } catch (err) {\n      if (err.response?.status === 401) {\n        setError('Session expired. Please log in again.');\n        toast.error('Session expired. Logging out...', { position: 'top-center' });\n      } else {\n        setError(err.response?.data?.error || 'Registration failed');\n        toast.error(err.response?.data?.error || 'Registration failed', { position: 'top-center' });\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50\"\n    >\n      <div className=\"bg-white p-6 rounded-xl shadow-lg border-t-4 border-primary w-full max-w-md\">\n        <h2 className=\"text-2xl font-semibold text-accent mb-4 flex items-center\">\n          <ArchiveBoxIcon className=\"w-6 h-6 text-primary mr-2\" />\n          Register Child Bags for {parent.qrCode}\n        </h2>\n        <p className=\"text-accent mb-4\">\n          Current: {currentCount}/{parent.childCount}\n        </p>\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <input\n            value={qr}\n            onChange={(e) => setQr(e.target.value)}\n            placeholder=\"Scan Child QR\"\n            className=\"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-accent\"\n            required\n          />\n          <div className=\"w-full bg-gray-200 rounded-full h-3\">\n            <motion.div\n              className=\"bg-primary h-3 rounded-full\"\n              initial={{ width: 0 }}\n              animate={{ width: `${(currentCount / parent.childCount) * 100}%` }}\n              transition={{ duration: 0.5 }}\n            />\n          </div>\n          <button\n            type=\"submit\"\n            disabled={isLoading}\n            className={`w-full py-3 rounded-lg text-white flex items-center justify-center ${\n              isLoading ? 'bg-gray-400' : 'bg-primary hover:bg-green-700'\n            } transition duration-300`}\n          >\n            {isLoading ? (\n              <svg className=\"animate-spin h-5 w-5 mr-2\" viewBox=\"0 0 24 24\">\n                <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" />\n                <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8v8z\" />\n              </svg>\n            ) : (\n              <ArchiveBoxIcon className=\"w-5 h-5 mr-2\" />\n            )}\n            Register Child\n          </button>\n        </form>\n      </div>\n    </motion.div>\n  );\n}\n\nexport default RegisterChildModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}